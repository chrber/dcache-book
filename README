#
# dCache Book Compliling Instructions
#
# (C) 2005 DESY, Germany
#
# Maintainer: Mathias de Riese <mathias.de.riese@desy.de>
#


###### Catalog inclusion
#
# docbook-xsl has to be installed and found via /etc/xml/catalog
# If this is not feasible, use 
#
export XML_CATALOG_FILES=/some/suitable/catalog



###### Static HTML into ./build/
#
rm -rf build
mkdir build
cp xsl/dcb.css build/dcb.css
xsltproc --nonet --xinclude -o build/ xsl/html-chunk.xsl Book.xml



###### SHTML for webserver with SSI enabled (dcache.org style)
#
# Several steps:
#

# 1. Copy header/footer/css files to the appropriate locations
#
DOCUMENT_ROOT=/var/www/html                     # Example
DCB_SUBDIR=dCache                               # Example (has to be at least one dir)
cp xsl/header.shtml ${DOCUMENT_ROOT}/
cp xsl/footer.shtml ${DOCUMENT_ROOT}/
cp xsl/manual_body.shtml ${DOCUMENT_ROOT}/${DCB_SUBDIR}/../
cp xsl/manual_end.shtml ${DOCUMENT_ROOT}/${DCB_SUBDIR}/../
cp xsl/dcb.css ${DOCUMENT_ROOT}/${DCB_SUBDIR}/

# 2. Compile sidebar TOC and copy to the right location:
#
rm -rf build
mkdir build
xsltproc --nonet --xinclude -o build/ xsl/html-dcache.org-sidebar.xsl Book.xml
cp build/index.shtml ${DOCUMENT_ROOT}/${DCB_SUBDIR}/sidebar-index.shtml

# 3. Compile acutal document
#
xsltproc --nonet --xinclude -o ${DOCUMENT_ROOT}/${DCB_SUBDIR}/ xsl/html-dcache.org.xsl Book.xml



###### Customization of the TOC in the sidebar
#
# After editing xsl/dcb-dcache.org-sidebar-title-tpl.xml
# the stylesheet  xsl/dcb-dcache.org-sidebar-title.xsl
# has to be regenerated with

xsltproc -nonet -output xsl/dcb-dcache.org-sidebar-title.xsl \
    http://docbook.sourceforge.net/release/xsl/current/template/titlepage.xsl \
    xsl/dcb-dcache.org-sidebar-title-tpl.xml


